#!/usr/bin/env python3
# Exploit Title: Platform 0.0.0-0.0.0 - Arbitrary Code Execution
# Date: XX/XX/20XX
# Exploit Author: UNICORD (NicPWNs & Dev-Yeoj)
# Vendor Homepage: https://platform.org/
# Software Link: https://github.com/platform/download
# Version: 0.0.0-0.0.0
# Tested on: Platform 0.0.0 (Debian)
# CVE: CVE-XXXX-XXXXX
# Source: https://github.com/UNICORDev/exploit-CVE-XXXX-XXXXX
# Description: Description from NIST

# Imports
import os
import subprocess
import sys

# Class for colors
class color:
    red = '\033[91m'
    gold = '\033[93m'
    blue = '\033[36m'
    green = '\033[92m'
    no = '\033[0m'

# Print UNICORD ASCII Art
def UNICORD_ASCII():
    print(rf"""
{color.red}        _ __,~~~{color.gold}/{color.red}_{color.no}        {color.blue}__  ___  _______________  ___  ___{color.no}
{color.red}    ,~~`( )_( )-\|       {color.blue}/ / / / |/ /  _/ ___/ __ \/ _ \/ _ \{color.no}
{color.red}        |/|  `--.       {color.blue}/ /_/ /    // // /__/ /_/ / , _/ // /{color.no}
{color.green}_V__v___{color.red}!{color.green}_{color.red}!{color.green}__{color.red}!{color.green}_____V____{color.blue}\____/_/|_/___/\___/\____/_/|_/____/{color.green}....{color.no}
    """)

# Print exploit help menu
def help():
    print(r"""UNICORD Exploit for CVE-XXXX-XXXXX

Usage:
  python3 exploit-CVE-XXXX-XXXXX.py -c <command>
  python3 exploit-CVE-XXXX-XXXXX.py -s <local-IP> <local-port>
  python3 exploit-CVE-XXXX-XXXXX.py -c <command> [-i <image.jpg>]
  python3 exploit-CVE-XXXX-XXXXX.py -s <local-IP> <local-port> [-i <image.jpg>]
  python3 exploit-CVE-XXXX-XXXXX.py -h

Options:
  -c    Custom command mode. Provide command to execute.
  -s    Reverse shell mode. Provide local IP and port.
  -i    Path to custom JPEG image. (Optional)
  -h    Show this help menu.
""")

# Run the exploit
def exploit(command):

    UNICORD_ASCII()

    print(f"{color.red}RUNNING: {color.blue}UNICORD Exploit for CVE-XXXX-XXXXX{color.no}")
    print(f"{color.red}PAYLOAD: {color.gold}" + command + f"{color.no}")
    print(f"{color.red}RUNTIME: {color.green}DONE - Exploit performed action.{color.no}\n")

    exit()

if __name__ == "__main__":

    args = ['-h','-c','-s','-i']

    if args[0] in sys.argv:
        help()

    elif args[1] in sys.argv and not args[2] in sys.argv:
        command = ""
        exploit(command)

    elif args[2] in sys.argv and not args[1] in sys.argv:
        command = ""
        exploit(command)

    else:
        help()
